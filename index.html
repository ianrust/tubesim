<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>SOCCER</title>
		<style>
			body { margin: 0; }
            .ui {position: absolute;}
            button{ margin: 20px; }
		</style>
	</head>
	<body>
        <div id="container"></div>
        <canvas id='canvas'></canvas>
        <button style="top:0; left:100px;" id="left" class="ui">Goal Left</button>
        <button style="top:0; left:200px;" id="right" class="ui">Goal Right</button>
        <button style="top:0; left:300px;" id="music" class="ui">Music Toggle</button>
        <button style="top:0; left:400px;" id="clear" class="ui">Clear</button>
		<script src="js/three.js"></script>
		<script src="js/stats.js"></script>
		<script src="js/factory.js"></script>
		<script src="js/pitch.js"></script>
		<script src="js/image.js"></script>
		<script src="recordings/u_got_that.json"></script>
		<script>

            var Module = {
                onRuntimeInitialized: () => {
                    var container, stats;

                    var scene = new THREE.Scene();

                    var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
                    var goals = new GoalController(scene, Module.getGoalsColor, song, Module.ControllerState);

                    const left = document.getElementById( "left");
                    const right = document.getElementById( "right");
                    const music = document.getElementById( "music");
                    const clear = document.getElementById( "clear");

                    left.addEventListener('click', (e) => {
                        goals.state.updateEvent(true, false);
                    });

                    right.addEventListener('click', (e) => {
                        goals.state.updateEvent(false, true);
                    });

                    music.addEventListener('click', (e) => {
                        goals.state.music_on = !goals.state.music_on;
                    });

                    clear.addEventListener('click', (e) => {
                        goals.state.goal_left = false;
                        goals.state.goal_right = false;
                        goals.state.music_on = false;
                    });

                    camera.rotation.x = Math.PI / 4.0;
                    camera.position.z = 13;
                    camera.position.y = -13;

                    var renderer = new THREE.WebGLRenderer();
                    renderer.setSize( window.innerWidth, window.innerHeight );
                    document.body.appendChild( renderer.domElement );
                    container = document.getElementById( 'container' );
                    container.appendChild( renderer.domElement );
                    stats = new Stats();
                    container.appendChild( stats.dom );

                    function animate() {
                        goals.update();

                        requestAnimationFrame( animate );
                        renderer.render( scene, camera );
                        stats.update();
                    }
                    animate();
                }
            };
		</script>
		<script src="js/patterns.js"></script>
	</body>
</html>